<div class="nested-fields sm:grid sm:grid-cols-3 sm:items-start sm:gap-4 sm:border-t sm:border-gray-200 sm:pt-5" data-new-record="<%= f.object.new_record? %>">
  <!-- Product Field -->
  <div class="col-span-2">
    <%= f.label :product_id, "Producto", class: "form-label" %>
    <select data-controller="select"
            data-select-model-value="Product"
            data-select-multi-select-value="false"
            data-select-placeholder-value="Selecciona un producto"
            name="<%= f.object_name %>[product_id]" 
            class="form-input">
      <!-- Placeholder Option -->
      <option value="" <%= 'selected' if f.object.product_id.blank? %>>Selecciona un producto</option>
      
      <% Product.all.each do |product| %>
        <option value="<%= product.id %>" <%= 'selected' if f.object.product_id == product.id %>><%= product.name %></option>
      <% end %>
    </select>
  </div>

  <%= f.input :automatic_quantity, wrapper_html: { class: 'col-span-1' } %>
  <%= f.input :presold_quantity, wrapper_html: { class: 'col-span-1' } %>
  <%= f.input :manual_quantity, wrapper_html: { class: 'col-span-1' } %>
  <%= f.input :supplied_quantity, wrapper_html: { class: 'col-span-1' } %>
  
  <div class="flex justify-end col-span-3">
    <%= link_to 'Eliminar', '#', class: 'text-sm text-red-600 hover:text-red-900', data: { action: "click->dynamic-form#remove" } %>
  </div>
</div>